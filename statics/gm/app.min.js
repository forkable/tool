require(["jquery","jquery-zclip","b"],function(){function h(c,a){var d=$.Deferred();$.ajax({type:"POST",url:c,data:a,dataType:"json",success:function(a){d.resolve(a)},error:function(a){d.reject(a)}});return d}function e(){var c=d[d.type];c.mUrl?($("#mUrl").val(c.mUrl),$("#ewmB").attr("src",c.ewm.B),$("#ewmC").attr("src",c.ewm.C),$("#copyUrl").addClass("checked")):($("#mUrl").val(""),$("#ewmB").attr("src",""),$("#ewmC").attr("src",""),$("#copyUrl").removeClass("checked"))}var d={type:"shop",shop:{pUrl:"",
mUrl:"",ewm:{B:"",C:"",size:"100"},shopId:""},"class":{pUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"},shopId:"",cateid:""},info:{pUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"},num_iid:""},wangwang:{pUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"}},coupon:{pUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"},sellerId:"",activityId:""},brand:{pUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"},brand_id:""},collocation:{pUrl:"",cpUrl:"",mUrl:"",ewm:{B:"",C:"",size:"100"},seller_id:"",meal_id:"",id:"",shopType:"taobao"}};$(".nav-slide").on("click",
function(c){var a=$(this).data("type");c=$(this);if(!c.hasClass("active"))if(c.siblings().removeClass("active"),c.addClass("active"),d.type=a,c=d[a],e(),$("#pUrl").val(c.pUrl),$("#ewmSize").val(c.ewm.size),"wangwang"==a?$("#pcTitle").text("\u65fa\u65fa\u6635\u79f0\uff1a"):$("#pcTitle").text("PC\u7aef\u5730\u5740\uff1a"),"collocation"==a){$(".collocation").show();for(var a=$(".shoptype"),f=0;f<a.length;f++)if(a[f].value==c.shopType){a[f].checked=!0;break}}else $(".collocation").hide()});$("#copyUrl").zclip({path:"./link/assets/images/ZeroClipboard.swf",
copy:function(){var c=d.type;if($(this).hasClass("checked"))return d[c].mUrl},afterCopy:function(){var c=$(this);c.html("\u590d\u5236\u6210\u529f");setTimeout(function(){c.html("\u590d\u5236")},1E3)}});$("#getPhoneUrl").on("click",function(){function c(){h("http://www.guanmeikj.com/gongju/sdktools/curl.php",{url:b.pUrl}).then(function(a){if(a){if("shop"==g){var c="http://gqrcode.alicdn.com/img?type=bs&v=1&shop_id="+a.shopid+"&w="+b.ewm.size+"&h="+b.ewm.size,f="http://gqrcode.alicdn.com/img?type=cs&v=1&shop_id="+
a.shopid+"&w="+b.ewm.size+"&h="+b.ewm.size;b.shopId=a.shopid;b.mUrl="https://shop"+a.shopid+".m.taobao.com";b.ewm.B=c;b.ewm.C=f;$("#mobileview").attr("src",b.mUrl)}else"class"==g&&(b.mUrl="https://shop.m.taobao.com/shop/shopIndex.htm?shop_id="+a.shopid+"#list?catId="+a.cateid,c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+d["class"].ewm.size+"&m=10&text="+d["class"].mUrl,b.shopId=a.shopid,b.cateid=a.cateid,b.ewm.B=c,b.ewm.C="",$("#mobileview").attr("src",b.mUrl));e()}},function(){})}
function a(){var a=b.pUrl.match(/id=([\d])+.*?/i);if(a){a=a[0].split("=").pop();b.num_iid=a;var a="http://gqrcode.alicdn.com/img?v=1&type=bi&item_id="+b.num_iid+"&w="+b.ewm.size+"&h="+b.ewm.size,c="http://gqrcode.alicdn.com/img?v=1&type=ci&item_id="+b.num_iid+"&w="+b.ewm.size+"&h="+b.ewm.size;b.mUrl="https://h5.m.taobao.com/awp/core/detail.htm?id="+b.num_iid;b.ewm.B=a;b.ewm.C=c;e();$("#mobileview").attr("src",b.mUrl)}}function f(){var a=b.pUrl.match(/seller_id=([\d])+.*?/i),c=b.pUrl.match(/meal_id=([\d])+.*?/i),
d=b.cpUrl.match(/(\&|\?)id=([\d])+.*?/i);a&&c&&d&&(b.seller_id=a[0].split("=").pop(),b.meal_id=c[0].split("=").pop(),b.id=d[0].split("=").pop(),b.mUrl="http://h5.m.taobao.com/detailplugin/mix.html?comboId="+b.meal_id+"&sellerId="+b.seller_id+"&type="+b.shopType+"&itemId="+b.id,b.ewm.B="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+b.ewm.size+"&m=10&text=http://h5.m.taobao.com/detailplugin/mix.html?comboId="+b.meal_id+"%26sellerId="+b.seller_id+"%26type="+b.shopType+"%26itemId="+
b.id,b.ewm.C="",e(),$("#mobileview").attr("src",b.mUrl))}function k(){var a=b.pUrl.match(/sellerId=([\d])+.*?/i),c=b.pUrl.match(/activityId=([\w])+.*?/i);a&&c&&(b.sellerId=a[0].split("=").pop(),b.activityId=c[0].split("=").pop(),b.mUrl="https://shop.m.taobao.com/shop/coupon.htm?sellerId="+b.sellerId+"&activityId="+b.activityId,b.ewm.B="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+b.ewm.size+"&m=10&text=https://shop.m.taobao.com/shop/coupon.htm?sellerId="+b.sellerId+"%26activityId="+
b.activityId,b.ewm.C="",e(),$("#mobileview").attr("src",b.mUrl))}function l(){var a=b.pUrl.match(/act_sign_id=([\d])+.*?/i);a&&(b.brand_id=a[0].split("=").pop(),b.mUrl="https://www.taobao.com/market/ju/branddetail.php?brand_id="+b.brand_id,b.ewm.B="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+b.ewm.size+"&m=10&text="+b.mUrl,b.ewm.C="",e(),$("#mobileview").attr("src",b.mUrl))}var g=d.type,b=d[g];if(!b.pUrl)return b.shopId="",b.mUrl="",b.ewm.B="",b.ewm.C="",e(),!1;"shop"==g||
"class"==g?c():"info"==g?a():"wangwang"==g?(b.mUrl="https://h5.m.taobao.com/ww/index.htm#!dialog-"+Base64.encode(b.pUrl),b.ewm.B="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+b.ewm.size+"&m=10&text="+b.mUrl,b.ewm.C="",e(),$("#mobileview").attr("src",b.mUrl)):"collocation"==g?f():"coupon"==g?k():"brand"==g&&l()});$("#pUrl").on("blur",function(){var c=$(this).val();/^http/.test(c);if(/(http|ftp|https):\/\/([\w-]+\.)+[\w-]+\.(com|net|cn|org|me|io|info|xxx)/.test(c)||"wangwang"==
d.type||"collocation"==d.type){var a=d.type,a=d[a];a.pUrl=c}else a=d.type,a=d[a],a.pUrl=""});$("#cpUrl").on("blur",function(){var c=$(this).val();d[d.type].cpUrl=c});$("#ewmSize").on("change",function(){var c=d.type,a=d[c];a.ewm.size=$(this).val();if(a.mUrl)if("shop"==c){var c="http://gqrcode.alicdn.com/img?type=bs&v=1&shop_id="+a.shopId+"&w="+a.ewm.size+"&h="+a.ewm.size,f="http://gqrcode.alicdn.com/img?type=cs&v=1&shop_id="+a.shopId+"&w="+a.ewm.size+"&h="+a.ewm.size;a.ewm.B=c;a.ewm.C=f;e()}else"class"==
c?(c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+a.ewm.size+"&m=10&text="+a.mUrl,a.ewm.B=c,e()):"info"==c?(c="http://gqrcode.alicdn.com/img?v=1&type=bi&item_id="+a.num_iid+"&w="+a.ewm.size+"&h="+a.ewm.size,f="http://gqrcode.alicdn.com/img?v=1&type=ci&item_id="+a.num_iid+"&w="+a.ewm.size+"&h="+a.ewm.size,a.ewm.B=c,a.ewm.C=f,e()):"coupon"==c?(c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+a.ewm.size+"&m=10&text="+("https://shop.m.taobao.com/shop/coupon.htm?sellerId="+
a.sellerId+"%26activityId="+a.activityId),a.ewm.B=c,e()):"wangwang"==c?(c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+a.ewm.size+"&m=10&text="+a.mUrl,a.ewm.B=c,e()):"collocation"==c?(c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+a.ewm.size+"&m=10&text=http://h5.m.taobao.com/detailplugin/mix.html?comboId="+a.meal_id+"%26sellerId="+a.seller_id+"%26type="+a.shopType+"%26itemId="+a.id,a.ewm.B=c,e()):"brand"==c&&(c="http://qr.liantu.com/api.php?bg=ffffff&fg=000000&gc=000000&el=l&w="+
a.ewm.size+"&m=10&text="+a.mUrl,a.ewm.B=c,e())});$("#mUrl").on("blur",function(){var c=d[d.type];c.mUrl=$(this).val();c.mUrl?$("#copyUrl").addClass("checked"):$("#copyUrl").removeClass("checked")});$(".shoptype").on("click",function(){d[d.type].shopType=$(this).val()})});
